# Send_Email

> ä¸€æ¬¾è½»é‡åŒ–å¯å®šåˆ¶æ¨¡æ¿çš„é‚®ä»¶æ‰¹é‡å‘é€å·¥å…· | å¯ç”¨äºæ”»é˜²é’“é±¼æˆ–å…¶ä»–é‚®ä»¶ä¸ªæ€§åŒ–çš„åœºæ™¯ | å¯å¯åŠ¨JavaFXæˆ–SpringWebç¯å¢ƒ

----



## 0x00. OvO

- **å¤šé‚®ç®±å‘é€**ï¼šæ”¯æŒé…ç½®å¤šä¸ªé‚®ç®±è´¦å·
- **éšæœºå­—ç¬¦æ›¿æ¢**ï¼šåœ¨é‚®ä»¶æ­£æ–‡ä¸­æ’å…¥éšæœºä¸å¯è§å­—ç¬¦ï¼Œè§„é¿å†…å®¹æ£€æµ‹
- **å¹²æ‰°å­—ç¬¦æ’å…¥**ï¼šéšæœºæ·»åŠ ä¸å¯è§å¹²æ‰°å­—ç¬¦ï¼Œæœ‰æ•ˆç»•è¿‡é‚®ä»¶ç½‘å…³
- **æ­£æ–‡ç¼–ç **ï¼šé‡‡ç”¨ `quoted-printable` ç¼–ç æŠ€æœ¯ï¼Œæå‡å†…å®¹ä¼ é€’çš„éšè”½æ€§
- **ä»£ç†æ”¯æŒ**ï¼šæ”¯æŒä»£ç†è®¾ç½®ï¼Œé™ä½ IP åœ°å€è¢«æ£€æµ‹é£é™©
- **å»¶è¿Ÿå‘é€**ï¼šå¯¹é‚®ä»¶å‘é€è®¾ç½®éšæœºå»¶è¿Ÿï¼Œå‡å°‘è¢«åˆ¤ä¸ºåƒåœ¾é‚®ä»¶çš„å¯èƒ½æ€§
- **æ ¼å¼è½¬æ¢**ï¼šæ”¯æŒ `.eml` æ–‡ä»¶å¯¼å…¥å¹¶è½¬æ¢ä¸º HTML æ ¼å¼
- **HTML æ ¼å¼æ”¯æŒ**ï¼šç›´æ¥å‘é€ HTML æ ¼å¼é‚®ä»¶ï¼Œæ‰“é€ ç²¾ç¾é‚®ä»¶å†…å®¹
- **å®šåˆ¶åŒ–é‚®ä»¶æ¨¡æ¿**ï¼šæ ¹æ®æ”¶ä»¶äººä¿¡æ¯å®šåˆ¶å†…å®¹ï¼Œå®ç°ä¸ªæ€§åŒ–é‚®ä»¶å‘é€

------



## 0x01. å¿«é€Ÿå¼€å§‹

### è¿è¡Œæ–¹å¼

é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ç¨‹åºï¼š

```bash
java -jar send_email.jar [web|gui]
```

- `web`ï¼šå¯åŠ¨ Spring Web
- `gui`ï¼šå¯åŠ¨ JavaFX å›¾å½¢åŒ–ç•Œé¢

### é…ç½®è¯´æ˜

é¦–æ¬¡è¿è¡Œæ—¶ï¼Œå·¥å…·ä¼šè‡ªåŠ¨ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼š è·¯å¾„ï¼š`~/.config/sendEmail/config.properties`

ç¤ºä¾‹ï¼š

```bash
ls -la ~/.config/sendEmail/
-rw-r--r--@  1 test  staff   833 Dec 10 09:55 config.properties
```

> è‹¥é…ç½®æ–‡ä»¶æœªç”Ÿæˆï¼Œè¯·ç¡®ä¿ `send_email.jar` å…·æœ‰å†™å…¥æƒé™ï¼š

```bash
chmod 777 send_email.jar
```

------



## 0x02. GUI æ¨¡å—

```bash
java -jar send_email.jar gui
```

### 2.1 é…ç½®é‚®ç®±è´¦æˆ·

è¿è¡Œå·¥å…·åï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤æ·»åŠ é‚®ç®±è´¦æˆ·ï¼ˆä»¥ 163 é‚®ç®±ä¸ºä¾‹ï¼‰ï¼š

1. æ‰“å¼€â€œé‚®ä»¶é…ç½®â€ç•Œé¢ï¼Œè¾“å…¥ä»¥ä¸‹ä¿¡æ¯ï¼š

   | é…ç½®é¡¹     | ç¤ºä¾‹å€¼                                         |
   | ---------- | ---------------------------------------------- |
   | åºå·       | ä» `0` å¼€å§‹é€’å¢                                |
   | æœåŠ¡å™¨åœ°å€ | smtp.163.com                                   |
   | ç«¯å£       | `25`ï¼ˆéåŠ å¯†ï¼‰/ `465`ï¼ˆåŠ å¯† SSLï¼‰              |
   | SSL        | `false`ï¼ˆç«¯å£ä¸º `25`ï¼‰/ `true`ï¼ˆç«¯å£ä¸º `465`ï¼‰ |
   | åŒ¿åé‚®ç®±   | `true`ï¼šåŒ¿åå‘é€/ `false`ï¼šéåŒ¿åå‘é€          |
   | é‚®ç®±ç”¨æˆ·å | example@163.com                                |
   | é‚®ç®±å¯†ç    | é‚®ç®±å¯†ç æˆ–æˆæƒç                                |
   | å‘ä»¶æ˜µç§°   | ç®¡ç†å‘˜                                         |
   | å‘ä»¶é‚®ç®±   | ä¸é‚®ç®±ç”¨æˆ·åç›¸åŒï¼ˆå¦‚ example@163.comï¼‰         |

   ![addConfig](C:\Users\kai12\OneDrive\Desktop\Send_Email-main\README.assets\addConfig.png)

2. ç‚¹å‡» **æ·»åŠ ** æŒ‰é’®ï¼Œå®Œæˆé…ç½®å†™å…¥

3. é€šè¿‡ **æŸ¥çœ‹é…ç½®** é€‰é¡¹ç¡®è®¤é…ç½®æ˜¯å¦æ­£ç¡®

   ![wechat_2024-12-14_191142_050](C:\Users\kai12\OneDrive\Desktop\Send_Email-main\README.assets\catConfig.png)

*ä¹Ÿå¯ä»¥ç›´æ¥æ‰‹åŠ¨ä¿®æ”¹é…ç½®æ–‡ä»¶*

*ç¤ºä¾‹ï¼š*

```properties
# ä»£ç†è®¾ç½®
proxy.enable=true
proxy.type=SOCKS5
proxy.host=127.0.0.1
proxy.port=7890
proxy.username=
proxy.password=

# é‚®ä»¶é…ç½® - å¯ä»¥é…ç½®å¤šä¸ªé‚®ç®±è´¦æˆ·
mail.accounts[0].id=0
mail.accounts[0].host=smtp.163.com
mail.accounts[0].port=465
mail.accounts[0].ssl=true
mail.accounts[0].username=xxxx@163.com
mail.accounts[0].password=xxxxxxx
mail.accounts[0].from=xxxx@163.com
mail.accounts[0].nickname=ç®¡ç†å‘˜
mail.accounts[0].authrequired=false

mail.accounts[1].id=1
mail.accounts[1].host=smtp.qq.com
mail.accounts[1].port=465
mail.accounts[1].ssl=true
mail.accounts[1].username=xxxx@foxmail.com
mail.accounts[1].password=xxxxxx
mail.accounts[1].from=xxxx@foxmail.com
mail.accounts[1].nickname=ç®¡ç†å‘˜
mail.accounts[1].authrequired=false
```

------

### 2.2 HTML è½¬æ¢

æ”¯æŒä»é‚®ç®±å¯¼å‡ºçš„ `.eml` æ–‡ä»¶ç›´æ¥è½¬æ¢ä¸º `.html` æ ¼å¼é‚®ä»¶ï¼Œå¹¶ä¿æŒåŸå§‹æ ·å¼è¿›è¡Œå‘é€ã€‚**åŸæ±åŸå‘³**ã€‚

![exportEML](README.assets/exportEML.png)

é¢„è§ˆå¯¼å‡ºåçš„HTMLæ ¼å¼ï¼š

![previewHTML](README.assets/previewHTML.png)

------

### 2.3 å‘é€é‚®ä»¶

å»ºè®®é…ç½®å¤šä¸ªé‚®ç®±è´¦æˆ·ï¼Œå½“ç¬¬ä¸€ä¸ªé‚®ç®±å‘é€å¤±è´¥æ—¶ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°å…¶ä»–é‚®ç®±

![sendEmailDemo](/README.assets/sendEmailDemo.png)

*æ”¶ä»¶å±•ç¤ºï¼š*

å‘é€æµç¨‹ï¼š

1. è¾“å…¥æˆ–å¯¼å…¥é‚®ä»¶å†…å®¹

2. ç¨‹åºä¼šæ‰§è¡Œä¸¤æ­¥ä¼˜åŒ–ï¼š

   - éšæœºæ’å…¥ä¸å¯è§å­—ç¬¦

     ![éšæœºæ’å…¥ä¸å¯è§å­—ç¬¦](/README.assets/éšæœºæ’å…¥ä¸å¯è§å­—ç¬¦.png)

   - éšæœºæ·»åŠ éšè—å¹²æ‰°å­—ç¬¦

     ![éšæœºæ’å…¥éšè—å†…å®¹](/README.assets/éšæœºæ’å…¥éšè—å†…å®¹.png)

3. å¯¹å†…å®¹è¿›è¡Œ`quoted-printable`ç¼–ç 

![QPCode](/README.assets/QPCode.png)




#### Tipsï¼š

1. **é™„ä»¶å‘é€**ï¼šå¯¹äº `.exe` ç­‰å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå»ºè®®å¤šæ¬¡æ‰“åŒ…æˆ–ä½¿ç”¨ 7z åŠ å¯†æ–‡ä»¶åï¼Œä»¥ç»•è¿‡ç½‘å…³æ£€æµ‹
2. **æ•æ„Ÿä¿¡æ¯**ï¼šå¯ä»¥å°†æ•æ„Ÿä¿¡æ¯è½¬æ¢ä¸ºå›¾ç‰‡æ’å…¥é‚®ä»¶ï¼Œç½‘å…³æ— æ³•æ£€æµ‹å›¾ç‰‡å†…å®¹

------

### 2.4 å®šåˆ¶åŒ–é‚®ä»¶

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥å¯¹é‚®ä»¶å†…å®¹è¿›è¡Œå®šåˆ¶åŒ–è®¾è®¡ï¼ˆä¾‹å¦‚é’ˆå¯¹æŸå•ä½çš„ç²¾å‡†æ¨å¹¿æˆ–ä¿¡æ¯åˆ†å‘ğŸ£ï¼‰ã€‚

ç¤ºä¾‹ï¼š

1. å°† `.eml` æ–‡ä»¶è½¬æ¢ä¸º `.html` æ–‡ä»¶ã€‚
2. ä½¿ç”¨ `thymeleaf` æ¨¡æ¿è¯­æ³•è¿›è¡Œæ’å€¼ï¼Œä¾‹å¦‚ï¼š`th:text="${userName}"`ã€‚

HTML æ¨¡æ¿ï¼ˆTest.htmlï¼‰ï¼š

```html
<!DOCTYPE html>
<html>
<div style="line-height:1.7;color:#000000;font-size:14px;font-family:Arial">
    <p>äº²çˆ±çš„ <span th:text="${userName}"></span> (å·¥å·: <span th:text="${workNo}"></span>)ï¼Œ</p>
    <p>ä»¥ä¸‹æ˜¯å…³äº <span th:text="${companyName}"></span> VPN çš„å®‰è£…æ‰‹å†Œï¼Œå¸®åŠ©æ‚¨é¡ºåˆ©å®Œæˆ VPN çš„è®¾ç½®å’Œä½¿ç”¨ã€‚</p>
    <hr>
    <h3 style="font-size: 14px;">
        ä¸ºäº†ç¡®ä¿å®‰å…¨çš„è¿œç¨‹è®¿é—®ï¼Œå…¬å¸è¦æ±‚é€šè¿‡ VPN æœåŠ¡å®‰å…¨åœ°è¿æ¥åˆ°å…¬å¸å†…éƒ¨ç½‘ç»œï¼Œè®¿é—®å¿…è¦çš„èµ„æºã€‚
    </h3>
    <ul>
        <li>æ“ä½œç³»ç»Ÿï¼šWindows 10ã€macOSã€Linux</li>
        <li>ç½‘ç»œè¿æ¥ï¼šç¨³å®šçš„äº’è”ç½‘è¿æ¥</li>
        <li>ä¸‹è½½é“¾æ¥ï¼š<a href="https://baidu.com/">XXVPNä¸‹è½½åœ°å€</a></li>
    </ul>
    <div>
        <b>æ³¨æ„äº‹é¡¹ï¼š</b>
    </div>
    <ul>
        <li><strong>æ— æ³•è¿æ¥ VPN</strong>ï¼šè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œç¡®ä¿è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç æ­£ç¡®ã€‚</li>
        <li><strong>è¿æ¥ä¸ç¨³å®š</strong>ï¼šå°è¯•é‡æ–°è¿æ¥ï¼Œæˆ–è”ç³» IT æ”¯æŒã€‚</li>
    </ul>
    <h4>è”ç³»æ”¯æŒ</h4>
    <p>å¦‚æ‚¨åœ¨å®‰è£…æˆ–ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯·è”ç³» IT æ”¯æŒå›¢é˜Ÿï¼š</p>
    <ul>
        <li>ç”µå­é‚®ä»¶ï¼š<a href="mailto:support@company.com" target="_blank">support@company.com</a></li>
        <li>ç”µè¯ï¼š123-456-7890</li>
    </ul>
    <hr>
    <p>æ„Ÿè°¢æ‚¨çš„é…åˆï¼Œç¥æ‚¨å·¥ä½œé¡ºåˆ©ï¼</p>
</div>
</html>
```

CSV æ•°æ®æ–‡ä»¶ï¼ˆTest.csvï¼‰ï¼š
*toEmailå’ŒemailSubjectä¸ºå¿…å¡«é¡¹*

| toEmail     | emailSubject    | userName | workNo | companyName             |
| ----------- | --------------- | -------- | ------ | ----------------------- |
| xxx@qq.com  | å®šåˆ¶åŒ–é‚®ä»¶ä¸»é¢˜1 | å¼ ä¼Ÿ     | 10086  | ä¸Šæµ·æµ¦å—æœºåœºæœºåœºè·¯198å· |
| xxx@126.com | å®šåˆ¶åŒ–é‚®ä»¶ä¸»é¢˜2 | æä¼Ÿ     | 10010  | è¥¿å®‰é«˜æ–°åŒºæ–°æ–°è·¯188å·   |
| xxx@163.com | å®šåˆ¶åŒ–é‚®ä»¶ä¸»é¢˜3 | ç‹ä¼Ÿ     | 10001  | å°åŒ—ä¸­å±±è·¯122å·         |

#### æ•ˆæœå±•ç¤º

![ç‹ä¼Ÿ](/README.assets/ç‹ä¼Ÿ.png)

![å¼ ä¼Ÿ](/README.assets/å¼ ä¼Ÿ.png)

----



## 0x03. WEB æ¨¡å—

`java -jar send_email.jar web`

è¿è¡Œ WEB æ¨¡å—åï¼Œç³»ç»Ÿä¼šç”Ÿæˆé»˜è®¤çš„ç™»å½•ç”¨æˆ·åå’Œå¯†ç ï¼š

- **ç”¨æˆ·å**ï¼š`user`
- **å¯†ç **ï¼šéšæœºç”Ÿæˆï¼ˆè¿è¡Œæ—¶åœ¨æ§åˆ¶å°è¾“å‡ºï¼Œä¾‹å¦‚ï¼š`Using generated security password: b068f0ca-3e4b-44a2-b5dc-967e051a7c1b`ï¼‰
- **ç«¯å£**ï¼š`58090`

------

ç™»å½•åæ ¹æ®æç¤ºè·³è½¬åˆ°Swagger-UIï¼Œè¿›è¡Œè°ƒç”¨APIä½¿ç”¨

![webIndex](/README.assets/webIndex.png)

![swagger-UI](/README.assets/swagger-UI.png)

Swagger-APIä¸­å‡æœ‰é…ç½®æ¥å£å’Œå‚æ•°è¯´æ˜ï¼Œè¿™é‡Œä¸å†åšæ¼”ç¤º

![swagger-demo](/README.assets/swagger-demo.png)

------



## 0x04. TODO

æ¬¢è¿åœ¨GitHubæissueså»ºè®®æˆ–éœ€æ±‚ã€‚

